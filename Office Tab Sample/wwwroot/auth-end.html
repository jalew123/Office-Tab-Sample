<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <script type="text/javascript" src="https://alcdn.msauth.net/browser/2.16.1/js/msal-browser.js"></script>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
    <script type="text/javascript">


        Office.initialize = async function () {
            const msalConfig = {
                auth: {
                    clientId: "cdb8813c-d7c7-4ef2-bf8a-2685c2341e5f",
                    redirectUri: location.protocol + "//" + location.hostname + "/auth-end.html",
                    navigateToLoginRequestUrl: false
                }
            };

            const clientApp = new msal.PublicClientApplication(msalConfig);

            let response = await clientApp.handleRedirectPromise();

            //document.getElementById("message").innerHTML = "Here: " + response.accessToken;

            Office.context.ui.messageParent(JSON.stringify({ status: "success", result: response.accessToken }));
        };

    </script>
</head>
<body>
    Auth end!

    <div id="message"></div>
</body>
</html>